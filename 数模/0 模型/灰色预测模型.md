---
importance: mild
---
灰色预测模型是指通过==少量的、不完全==的信息，建立数学模型并作出预测的一种预测方法，是处理==小样本==预测问题的有效工具。
1. 系统因素不完全明确
2. 因素关系不完全清楚
3. 系统的结构不完全知道
4. 系统的作用原理不完全明了


# 1 GM(1,1) 模型
已知参考序列 $x^{(0)}=(x^{(0)}(1),x^{(0)}(2),\cdots,x^{(0)}(n))$  ，它的一次累加序列为 $x^{(1)}=(x^{(1)}(1),x^{(1)}(2),\cdots,x^{(1)}(n))$ ，其中 $x^{(1)}(k)=\sum_{i=1}^kx^{(0)}(i),k=1,2,\ldots,n$  . $x^{(1)}$ 的均值生成序列为 $z^{(1)}=(z^{(1)}(1),z^{(1)}(2),\cdots,z^{(1)}(n))$ . 建立灰微分方程：$$x^{(0)}(k)+az^{(1)}(k)=b,k=1,2,\ldots,n.$$ 通过[[最小二乘法]]可以计算出 $a$ 和 $b$ 的值。在计算其相应的白化微分方程：$$\dfrac{\mathrm{d}x^{(1)}(t)}{\mathrm{d}t}+ax^{(1)}(t)=b$$ 得出预测值 $x^{(0)}(n+1)$ .

# 2 建模步骤
## 2.1 级比检验
设 $\lambda (k)=\dfrac{x^{(0)}(k-1)}{x^{(0)}(k)},k=2,3,\ldots,n$ . 若所有级比均落在可溶覆盖区间 $X=(\mathrm{e}^{-\frac{2}{n+1}},\mathrm{e}^{\frac{2}{n+1}})$ 内，则可以建立 $GM(1,1)$ 模型，若不满足需进行数据平移。

## 2.2 建立模型
建立 $GM(1,1)$ 模型，则可以得到预测值：$$\hat{x}^{(1)}(k+1)=\left(x^{(0)}(1)-\frac{\hat{b}}{\hat{a}}\right)\mathrm{e}^{-\hat{a}k}+\frac{\hat{b}}{\hat{a}},\quad k=0,1,\ldots,n-1,\ldots$$ 

## 2.3 检测预测值
### 2.3.1 相对误差检验
计算相对误差：$$\delta(k)=\frac{|x^{(0)}(k)-\hat{x}^{(0)}(k)|}{x^{(0)}(k)},\quad k=1,2,\ldots,n$$ 这里 $\hat{x}^{(0)}(1)=x^{(0)}(1)$ ，如果 $\delta(k)<0.2$，则认为达到一般要求；如果 $\delta(k)<0.1$，则认为达到较高要求.

### 2.3.2 级比偏差值检验
已知级比 $\lambda(k)$ 和发展系数 $\hat{a}$ ，计算：$$\rho(k)=\left|1-\left(\frac{1-0.5\hat{a}}{1+0.5\hat{a}}\right)\lambda(k)\right|$$ 如果 $\rho(k)<0.2$ ，则认为达到一般要求；如果 $\rho(k)<0.1$ ，则认为达到较高要求.

# 3 例题
北方某城市 $1986-1992$ 年道路交通噪声平均声级数据如下表所示：

|年份|$L_{eq}$|
|:-:|:-:|
|1986|71.1|
|1987|72.4|
|1988|72.4|
|1989|72.1|
|1990|71.4|
|1991|72.0|
|1992|71.6|

求1993年的预测值。
先进行级比检验：$$(\lambda(2),\lambda(3),\cdots,\lambda(7))=(0.982,1,11.0042,1.0098,0.9917,1.0056)$$ 
由于所有的级比 $\lambda(k)\in\left[\mathrm{e}^{-\frac{2}{7+1}},\mathrm{e}^{\frac{2}{7+1}}\right]$ ，故可以进行 $GM(1,1)$ 建模
对原始序列进行累加，得到累加序列：$$x^{(1)}=(71.1,~143.5,~215.9,~288,~359.4,~431.4,~503)$$ 
构造数据矩阵 $B$ 和数据向量 $Y$ ：$$B=\begin{bmatrix}-\dfrac{1}{2}\left(x^{(1)}(1)+x^{(2)}(2)\right)&1\\ -\dfrac{1}{2}\left(x^{(1)}(2)+x^{(2)}(3) \right)&1\\\vdots&\vdots\\-\dfrac{1}{2}\left(x^{(1)}(6)+x^{(2)}(7)\right)&1\end{bmatrix},\quad Y=\begin{bmatrix}x^{(0)}(2)\\x^{(0)}(3)\\ \vdots\\x^{(0)}(7)\end{bmatrix}$$ 
根据[[numpy库#1 最小二乘法 下的多项式拟合]]可得：$$\begin{bmatrix}\hat{a}\\ \hat{b}\end{bmatrix}=(B^TB)^{-1}B^TY=\begin{bmatrix}0.0023\\72.6573\end{bmatrix}$$ 
建立模型：$$\frac{\mathrm{d}x^{(1)}(t)}{\mathrm{d}t}+\hat{a}x^{(1)}(t)=\hat{b}$$ 
得出通解 $x(t)=31590.1304347826 - 31591.6076365702\mathrm{e}^{-0.0023t}$ ，得出第七年的预测值 71.58